require 'test_helper'

class MinPricesTest < ActiveSupport::TestCase

  include MultiplePriceRetriever

  test "Test get_multiple_min_prices_from_eve_central" do
    get_prices( 30000142, [ 34, 35, 36, 37, 38, 39 ] )
  end

  test "Test get_multiple_min_prices_from_eve_central with huge amount of items" do
    components = [38, 34, 35, 36, 37, 39, 40, 11399, 3689, 483, 11541, 11689, 11482, 21025, 24547, 24545, 21035, 24556, 21037, 24558, 24560, 21009, 21011, 21013, 21017, 21019, 21021, 21023, 3685, 377, 11558, 11484, 393, 9838, 399, 11556, 11530, 11531, 11475, 439, 11549, 434, 11534, 9840, 9842, 11540, 11483, 447, 520, 11538, 526, 523, 11539, 9848, 11554, 529, 1197, 11543, 11544, 11545, 1244, 1246, 1254, 1264, 11542, 1274, 1284, 1294, 1304, 1317, 3828, 1333, 1353, 1403, 2331, 11536, 1182, 11551, 1445, 1539, 1547, 11692, 11693, 1551, 11695, 1557, 11694, 1563, 443, 1875, 11486, 577, 1195, 442, 11553, 2046, 580, 11535, 11537, 9834, 11481, 2173, 2183, 11688, 2193, 2203, 578, 11555, 11557, 2289, 2291, 2293, 2295, 444, 581, 524, 499, 501, 503, 1201, 11690, 2444, 2454, 2464, 2476, 11691, 2486, 2529, 2537, 2545, 1808, 2603, 16680, 11476, 9830, 2867, 2868, 2869, 2870, 2871, 2872, 2875, 2876, 3242, 17392, 2348, 2463, 1968, 1948, 1958, 1955, 1956, 12269, 573, 574, 498, 568, 496, 570, 493, 564, 491, 565, 488, 16672, 486, 13320, 453, 454, 458, 459, 462, 464, 25335, 497, 484, 490, 487, 492, 489, 494, 495, 461, 452, 451, 457, 450, 463, 561, 567, 572, 571, 566, 569, 575, 562, 563, 455, 2022, 1185, 2018, 2020, 456, 21029, 11532, 3528, 20701, 24569, 3538, 20703, 3616, 20450, 20448, 20444, 20446, 32444, 3566, 20539, 20454, 20452, 3576, 12219, 3585, 3586, 3584, 22175, 3583, 3596, 3606, 3653, 3663, 21041, 3829, 3839, 2360, 9846, 2351, 3937, 3941, 3947, 3953, 3977, 3981, 3987, 27904, 3993, 460, 28654, 24348, 24644, 11563, 27914, 17938, 18639, 20069, 16681, 16682, 20409, 22227, 20406, 20405, 11052, 22553, 22557, 22555, 20124, 22228, 20514, 20070, 11017, 20408, 20280, 27951, 27930, 27932, 3683, 9832, 44, 16272, 16273, 17887, 17888, 16274, 17889, 25600, 25597, 25599, 3687, 25604, 25616, 25617, 25623, 4393, 9944, 10246, 10629, 10678, 10840, 10836, 10838, 11478, 11547, 607, 609, 11552, 583, 11533, 11550, 586, 11548, 589, 29248, 2161, 605, 584, 585, 608, 11217, 11227, 11237, 11247, 11257, 11267, 597, 587, 593, 603, 3766, 10998, 11301, 11305, 11303, 11277, 3887, 2004, 2002, 2003, 2005, 1947, 1959, 1957, 2363, 1963, 1973, 1986, 2579, 2583, 2587, 2591, 4013, 1977, 2108, 1998, 2103, 20431, 632, 630, 628, 633, 631, 620, 625, 634, 621, 623, 622, 2006, 626, 629, 624, 627, 602, 598, 590, 594, 12056, 12066, 12052, 12054, 12225, 11370, 12217, 12257, 12261, 12265, 12344, 12354, 16679, 16673, 16670, 16671, 648, 649, 19744, 653, 650, 655, 652, 1944, 2349, 2361, 530, 533, 485, 16678, 16683, 33361, 33362, 33360, 17317, 33359, 17482, 12108, 18036, 18038, 18040, 18042, 18044, 18046, 18048, 18050, 18052, 18054, 18056, 18058, 18060, 18062, 18066, 18064, 21039, 12709, 21027, 11291, 11293, 11295, 11297, 11299, 11279, 21074, 21078, 21082, 21084, 21086, 21080, 21088, 21075, 21087, 21079, 21591, 21725, 21590, 21726, 21587, 21724, 21077, 21081, 21085, 21728, 21588, 21727, 21089, 21076, 16275, 20110, 21584, 21721, 21569, 21571, 21720, 21585, 21719, 21570, 21732, 21593, 21595, 21596, 21733, 21722, 21572, 21073, 21723, 21568, 21586, 21731, 21730, 21592, 21729, 21594, 15508, 15510, 21953, 21955, 21957, 21961, 21965, 21967, 21969, 21947, 21949, 21951]
    last_component = components.last
    result_hash = get_prices( 30000142, components )
    assert_includes result_hash.keys, last_component
  end

end
